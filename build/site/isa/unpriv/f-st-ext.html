<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: RISC-V Ratified Specifications Library</title>
    <link rel="prev" href="cmo.html">
    <link rel="next" href="d-st-ext.html">
    <meta name="generator" content="Antora 3.1.10">
    <script>
!function (theme, navWidth) {
  if (theme === 'dark') document.documentElement.classList.add('dark-theme')
  if (navWidth) document.documentElement.style.setProperty('--nav-width', `${navWidth}px`)
}(localStorage && localStorage.getItem('theme') || (matchMedia('(prefers-color-scheme: dark)')?.matches && 'dark'),
  localStorage && localStorage.getItem('nav-width'))
    </script>
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/vendor/search.css">
    <link rel="stylesheet" href="../../_/css/vendor/page-search.css">
    <link rel="stylesheet" href="../../_/css/vendor/spring-tabs.css">

    <meta name="antora-ui-version" content="v0.4.16"> 
    <meta name="version" content="">
    <meta name="component" content="isa">
    <meta name="latest-version" content="false">
    <link rel="icon" href="../../_/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://spring.io">
        <img
          id="springlogo"
          class="block"
          src="../../_/img/spring-logo.svg"
          alt="Spring"
        />
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Why Spring</a>
          <div class="navbar-dropdown">
            <a
              class="navbar-item"
              href="https://spring.io/why-spring"
            >Overview</a>
            <a
              class="navbar-item"
              href="https://spring.io/microservices"
            >Microservices</a>
            <a
              class="navbar-item"
              href="https://spring.io/reactive"
            >Reactive</a>
            <a class="navbar-item" href="https://spring.io/event-driven">Event
              Driven</a>
            <a class="navbar-item" href="https://spring.io/cloud">Cloud</a>
            <a class="navbar-item" href="https://spring.io/web-applications">Web
              Applications</a>
            <a
              class="navbar-item"
              href="https://spring.io/serverless"
            >Serverless</a>
            <a class="navbar-item" href="https://spring.io/batch">Batch</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Learn</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://spring.io/learn">Overview</a>
            <a
              class="navbar-item"
              href="https://spring.io/quickstart"
            >Quickstart</a>
            <a class="navbar-item" href="https://spring.io/guides">Guides</a>
            <a class="navbar-item" href="https://spring.io/blog">Blog</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Projects</a>
          <div class="navbar-dropdown" style="min-width: 280px">
            <a
              class="navbar-item"
              href="https://spring.io/projects"
            >Overview</a>
            <a
              class="navbar-item"
              href="https://spring.io/projects/spring-boot"
            >Spring Boot</a>
            <a
              class="navbar-item"
              href="https://spring.io/projects/spring-framework"
            >Spring Framework</a>
            <a
              class="navbar-item"
              href="https://spring.io/projects/spring-cloud"
            >Spring Cloud</a>
            <a
              class="navbar-item"
              href="https://spring.io/projects/spring-cloud-dataflow"
            >Spring Cloud Data Flow</a>
            <a
              class="navbar-item"
              href="https://spring.io/projects/spring-data"
            >Spring Data</a>
            <a
              class="navbar-item"
              href="https://spring.io/projects/spring-integration"
            >Spring Integration</a>
            <a
              class="navbar-item"
              href="https://spring.io/projects/spring-batch"
            >Spring Batch</a>
            <a
              class="navbar-item"
              href="https://spring.io/projects/spring-security"
            >Spring Security</a>
            <a
              class="navbar-item navbar-item-special"
              href="https://spring.io/projects"
            >View all projects</a>
            <li class="navbar-item navbar-item-special-3">DEVELOPMENT TOOLS</li>
            <a class="navbar-item" href="https://spring.io/tools">Spring Tools 4</a>
            <a
              class="navbar-item navbar-item-special-2"
              href="https://start.spring.io"
            >Spring Initializr
              <svg
                class="external-link-icon"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 16 16"
              ><polyline
                  points="15 10.94 15 15 1 15 1 1 5.06 1"
                  fill="none"
                  stroke="currentColor"
                  stroke-miterlimit="10"
                  stroke-width="2"
                ></polyline><polyline
                  points="8.93 1 15 1 15 7.07"
                  fill="none"
                  stroke="currentColor"
                  stroke-miterlimit="10"
                  stroke-width="2"
                ></polyline><line
                  x1="15"
                  y1="1"
                  x2="8"
                  y2="8"
                  fill="none"
                  stroke="currentColor"
                  stroke-miterlimit="10"
                  stroke-width="2"
                ></line></svg></a>
          </div>
        </div>

        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Academy</a>
          <div class="navbar-dropdown">
            <a
              class="navbar-item"
              href="https://spring.academy/courses"
            >Courses</a>
            <a
              class="navbar-item"
              href="https://spring.academy/learning-path"
            >Get Certified</a>
          </div>
        </div>

        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Solutions</a>
          <div class="navbar-dropdown lg">
            <a class="navbar-item" href="https://spring.io/solutions">Overview</a>
            <a class="navbar-item" href="https://spring.io/support">Spring Runtime</a>
            <a class="navbar-item" href="https://spring.io/consulting">Spring Consulting</a>
            <a class="navbar-item" href="https://spring.academy/teams">Spring Academy For Teams</a>
            <a class="navbar-item" href="https://spring.io/security">Security Advisories</a>
          </div>
        </div>

        <div class="navbar-item has-dropdown is-hoverable is-community">
          <a class="navbar-link" href="#">Community</a>
          <div class="navbar-dropdown">
            <a
              class="navbar-item"
              href="https://spring.io/community"
            >Overview</a>
            <a class="navbar-item" href="https://spring.io/events">Events</a>
            <a class="navbar-item" href="https://spring.io/team">Team</a>
          </div>
        </div>
      </div>
    </div>
    <label class="theme-toggler">
      <input
        type="checkbox"
        type="checkbox"
        id="switch-theme-checkbox"
        name="switch-theme-checkbox"
      />
      <span class="icon"><svg
          aria-hidden="true"
          focusable="false"
          data-prefix="fas"
          data-icon="moon"
          class="svg-inline--fa fa-moon moon"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 384 512"
        ><path
            fill="currentColor"
            d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"
          ></path>
        </svg>
        <svg
          aria-hidden="true"
          focusable="false"
          data-prefix="fas"
          data-icon="sun"
          class="svg-inline--fa fa-sun sun"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 512 512"
        ><path
            fill="currentColor"
            d="M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z"
          ></path>
        </svg></span>
      <span class="text">light</span>
    </label>
  </nav>
</header>
<script>
!function (theme) {
  if (theme === 'dark') {
    document.getElementById('switch-theme-checkbox').parentElement.classList.add('active')
  }
}(localStorage && localStorage.getItem('theme') || (matchMedia('(prefers-color-scheme: dark)')?.matches && 'dark'))
</script>
<div class="body">
<div class="nav-container" data-component="isa" data-version="">
  <aside class="nav">
    <div class="panels">
      <div class="nav-panel-menu is-active" data-panel="menu">
        <nav class="nav-menu">
<div class="context">
  <span class="title">ISA Specifications</span>
  <span class="version">default</span>
  <button class="browse-version" id="browse-version">
    <svg
      height="24px"
      id="Layer_1"
      style="enable-background:new 0 0 512 512;"
      version="1.1"
      viewBox="0 0 512 512"
      width="24px"
      xml:space="preserve"
    ><g><path
          d="M256,224c-17.7,0-32,14.3-32,32s14.3,32,32,32c17.7,0,32-14.3,32-32S273.7,224,256,224L256,224z"
        ></path><path
          d="M128.4,224c-17.7,0-32,14.3-32,32s14.3,32,32,32c17.7,0,32-14.3,32-32S146,224,128.4,224L128.4,224z"
        ></path><path
          d="M384,224c-17.7,0-32,14.3-32,32s14.3,32,32,32s32-14.3,32-32S401.7,224,384,224L384,224z"
        ></path></g></svg>
  </button>
  </div><ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Volume I: RISC-V Unprivileged ISA Specification</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="colophon.html">Preface</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="intro.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="rv32.html">RV32I Base Integer Instruction Set</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="rv32e.html">RV32E and RV64E Base Integer Instruction Sets, Version 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="rv32.html">RV64I Base Integer Instruction Set</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="rv128.html">RV128I Base Integer Instruction Set, Version 1.7</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="zifencei.html">"Zifencei" Extension for Instruction-Fetch Fence, Version 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="zicsr.html">"Zicsr", Extension for Control and Status Register (CSR) Instructions, Version 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="counters.html">"Zicntr" and "Zihpm" Extensions for Counters, Version 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="zihintntl.html">"Zihintntl" Extension for Non-Temporal Locality Hints, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="zihintpause.html">"Zihintpause" Extension for Pause Hint, Version 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="zimop.html">"Zimop" Extension for May-Be-Operations, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="zicond.html">"Zicond" Extension for Integer Conditional Operations, Version 1.0.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="m-st-ext.html">"M" Extension for Integer Multiplication and Division, Version 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="a-st-ext.html">"A" Extension for Atomic Instructions, Version 2.1</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="zawrs.html">"Zawrs" Extension for Wait-on-Reservation-Set instructions, Version 1.01</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="zacas.html">"Zacas" Extension for Atomic Compare-and-Swap (CAS) Instructions, Version 1.0.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="zabha.html">"Zabha" Extension for Byte and Halfword Atomic Memory Operations, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="rvwmo.html">RVWMO Memory Consistency Model, Version 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="ztso-st-ext.html">"Ztso" Extension for Total Store Ordering, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="cmo.html">"CMO" Extensions for Base Cache Management Operation ISA, Version 1.0.0</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link"  href="f-st-ext.html">"F" Extension for Single-Precision Floating-Point, Version 2.2</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="d-st-ext.html">"D" Extension for Double-Precision Floating-Point, Version 2.2</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="q-st-ext.html">"Q" Extension for Quad-Precision Floating-Point, Version 2.2</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="zfh.html">"Zfh" and "Zfhmin" Extensions for Half-Precision Floating-Point, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="bfloat16.html">"BF16" Extensions for for BFloat16-precision Floating-Point, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="zfa.html">"Zfa" Extension for Additional Floating-Point Instructions, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="zfinx.html">"Zfinx", "Zdinx", "Zhinx", "Zhinxmin" Extensions for Floating-Point in Integer Registers, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="c-st-ext.html">"C" Extension for Compressed Instructions, Version 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="zc.html">"Zc*" Extension for Code Size Reduction, Version 1.0.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="b-st-ext.html">"B" Extension for Bit Manipulation, Version 1.0.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="p-st-ext.html">"P" Extension for Packed-SIMD Instructions, Version 0.2</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="v-st-ext.html">"V" Standard Extension for Vector Operations, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="scalar-crypto.html">Cryptography Extensions: Scalar &amp; Entropy Source Instructions, Version 1.0.1</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="vector-crypto.html">Cryptography Extensions: Vector Instructions, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="unpriv-cfi.html">Control-flow Integrity (CFI)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="rv-32-64g.html">RV32/64G Instruction Set Listings</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="extending.html">Extending RISC-V</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="naming.html">ISA Extension Naming Conventions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="history.html">History and Acknowledgments</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="mm-eplan.html">Appendix A: RVWMO Explanatory Material, Version 0.1</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="mm-formal.html">Appendix B: Formal Memory Model Specifications, Version 0.1</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="vector-examples.html">Appendix C: Vector Assembly Code Examples</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="calling-convention.html">Appendix D: Calling Convention for Vector State (Not authoritative - Placeholder Only)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Volume II: RISC-V Privileged ISA Specification</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="../priv/priv-intro.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="../priv/priv-csrs.html">Control and Status Registers (CSRs)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="../priv/machine.html">Machine-Level ISA, Version 1.13</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="../priv/indirect-csr.html">"Smcsrind/Sscsrind" Indirect CSR Access, version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="../priv/smcntrpmf.html">"Smcntrpmf" Cycke and Instret Privilege Mode Filtering, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="../priv/rnmi.html">"Smrnmi" Extension for Resumable Non-Maskable Interrupts, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="../priv/smcdeleg.html">"Smcdeleg" Counter Delegation Extension, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="../priv/hypervisor.html">"H" Extension for Hypervisor Support, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="../priv/priv-cfi.html">Control-flow Integrity(CFI)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="../priv/priv-insns.html">RISC-V Privileged Instruction Set Listings</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="../priv/priv-history.html">History</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link"  href="../priv/bibliography.html">Bibliography</a>
  </li>
</ul>
  </li>
</ul>
          <div class="toggle-sm">
            <button id="nav-toggle-2" class="nav-toggle"></button>
          </div>
        </nav>
      </div>
      <div class="nav-collapse">
        <button id="nav-collapse-toggle"><span></span></button>        
      </div>
    </div>
    <div class="nav-resize"></div>
  </aside>
</div>
<script>
!function (sidebar) {
  if (sidebar) {
    document.body.classList.add('nav-sm')
  }
}(localStorage && localStorage.getItem('sidebar') === 'close')
</script><main class="article">
<div class="toolbar" role="navigation">
  <button id="nav-toggle-1" class="nav-toggle"></button>
</div>
  <div class="content">
<aside class="sidebar">
  <div class="content">
    <div
      class="toc"
      data-title=""
      data-levels="2"
    >
      <div class="toc-menu"></div>
    </div>
    <div class="sidebar-links">
        <a href="https://github.com/riscv/riscv-isa-manual/edit/antora-refactor/modules/unpriv/pages/f-st-ext.adoc">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="24"
            viewBox="0 0 24 24"
            width="24"
          ><path
              d="m16 2.012 3 3L16.713 7.3l-3-3zM4 14v3h3l8.299-8.287-3-3zm0 6h16v2H4z"
            ></path></svg>
          Edit this Page
        </a>
              <a href="https://github.com/riscv/riscv-isa-manual" title="Source Repository">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="512px" height="512px" fill="none">
    <path d="M23.6188 12.9999L19.8886 2.82896C19.7371 2.4083 19.122 2.4083 18.9705 2.82896L16.494 9.99994H7.50604L5.02956 2.82896C4.87803 2.4083 4.26295 2.4083 4.11142 2.82896L0.381247 12.9999C0.276408 13.289 0.404366 13.6112 0.678 13.7651L11.5243 19.6958C11.8256 19.8611 12.1744 19.8611 12.4757 19.6958L23.322 13.7651C23.5956 13.6112 23.7236 13.289 23.6188 12.9999Z" fill="#E24329"/>
    <path d="M12.0001 19.1956L16.4941 9.99996H7.5061L12.0001 19.1956Z" fill="#FCA326"/>
    <path d="M12.0001 19.1955L7.5061 9.99988H3.24121L12.0001 19.1955Z" fill="#E24329"/>
    <path d="M3.24121 9.99988L0.381226 12.9998C0.276388 13.2889 0.404345 13.6111 0.678 13.765L12.0001 19.1955L3.24121 9.99988Z" fill="#FCA326"/>
    <path d="M12.0001 19.1955L16.4941 9.99988H20.7589L12.0001 19.1955Z" fill="#E24329"/>
    <path d="M20.7589 9.99988L23.6188 12.9998C23.7237 13.2889 23.5957 13.6111 23.322 13.765L12.0001 19.1955L20.7589 9.99988Z" fill="#FCA326"/>
    <path d="M16.494 9.99988H20.7589L18.9705 2.82894C18.819 2.40828 18.2039 2.40828 18.0524 2.82894L16.494 9.99988Z" fill="#E24329"/>
    <path d="M7.50603 9.99988H3.24121L4.11141 2.82894C4.26294 2.40828 4.87802 2.40828 5.02955 2.82894L7.50603 9.99988Z" fill="#E24329"/>
  </svg>
  Source Repository
</a>
    </div>
  </div>
</aside>
<article class="doc">
<div class="breadcrumbs-container">
  <nav class="breadcrumbs" aria-label="breadcrumbs">
    <ul>
      <li><a href="../index.html">ISA Specifications</a></li>
      <li>Volume I: RISC-V Unprivileged ISA Specification</li>
      <li><a href="f-st-ext.html">"F" Extension for Single-Precision Floating-Point, Version 2.2</a></li>
    </ul>
  </nav>
</div><div class="sect1">
<h2 id="single-float"><a class="anchor" href="#single-float"></a>"F" Extension for Single-Precision Floating-Point, Version 2.2</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes the standard instruction-set extension for
single-precision floating-point, which is named "F" and adds
single-precision floating-point computational instructions compliant
with the IEEE 754-2008 arithmetic standard cite:[ieee754-2008]. The F extension depends on the "Zicsr" extension for control and status register access.</p>
</div>
<div class="sect2">
<h3 id="f-register-state"><a class="anchor" href="#f-register-state"></a>F Register State</h3>
<div class="paragraph">
<p>The F extension adds 32 floating-point registers, <code>f0-f31</code>, each 32
bits wide, and a floating-point control and status register <code>fcsr</code>,
which contains the operating mode and exception status of the
floating-point unit. This additional state is shown in
<a href="#fprs">RISC-V standard F extension single-precision floating-point state</a>. We use the term FLEN to describe the width of
the floating-point registers in the RISC-V ISA, and FLEN=32 for the F
single-precision floating-point extension. Most floating-point
instructions operate on values in the floating-point register file.
Floating-point load and store instructions transfer floating-point
values between registers and memory. Instructions to transfer values to and from the integer register file are also provided.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We considered a unified register file for both integer and
floating-point values as this simplifies software register allocation
and calling conventions, and reduces total user state. However, a split
organization increases the total number of registers accessible with a
given instruction width, simplifies provision of enough regfile ports
for wide superscalar issue, supports decoupled floating-point-unit
architectures, and simplifies use of internal floating-point encoding
techniques. Compiler support and calling conventions for split register
file architectures are well understood, and using dirty bits on
floating-point register file state can reduce context-switch overhead.</p>
</div>
</td>
</tr>
</table>
</div>
<table id="fprs" class="tableblock frame-all grid-rows" style="width: 50%;">
<caption class="title">Table 1. RISC-V standard F extension single-precision floating-point state</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><span class="small">FLEN-1</span></th>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-right valign-top"><span class="small">0</span></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f0</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f1</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f2</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f3</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f4</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f5</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f6</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f7</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f8</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f9</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f10</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f11</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f12</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f13</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f14</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f15</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f16</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f17</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f18</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f19</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f20</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f21</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f22</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f23</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f24</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f25</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f26</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f27</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f28</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f29</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f30</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">f31</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">FLEN</span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="small">31</span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-right valign-top"><p class="tableblock"><span class="small">0</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">fcsr</span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><span class="small">32</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="floating-point-control-and-status-register"><a class="anchor" href="#floating-point-control-and-status-register"></a>Floating-Point Control and Status Register</h3>
<div class="paragraph">
<p>The floating-point control and status register, <code>fcsr</code>, is a RISC-V
control and status register (CSR). It is a 32-bit read/write register
that selects the dynamic rounding mode for floating-point arithmetic
operations and holds the accrued exception flags, as shown in <a href="#fcsr">Floating-Point Control and Status Register</a>.</p>
</div>
<div id="fcsr" class="paragraph">
<div class="title">Floating-point control and status register</div>
<p>Unresolved include directive in modules/unpriv/pages/f-st-ext.adoc - include::images/wavedrom/float-csr.edn[]</p>
</div>
<div class="paragraph">
<p>The <code>fcsr</code> register can be read and written with the FRCSR and FSCSR
instructions, which are assembler pseudoinstructions built on the
underlying CSR access instructions. FRCSR reads <code>fcsr</code> by copying it
into integer register <em>rd</em>. FSCSR swaps the value in <code>fcsr</code> by copying
the original value into integer register <em>rd</em>, and then writing a new
value obtained from integer register <em>rs1</em> into <code>fcsr</code>.</p>
</div>
<div class="paragraph">
<p>The fields within the <code>fcsr</code> can also be accessed individually through
different CSR addresses, and separate assembler pseudoinstructions are defined
for these accesses. The FRRM instruction reads the Rounding Mode field <code>frm</code>
(<code>fcsr</code> bits 7&#8212;&#8203;5) and copies it into the least-significant three bits of
integer register <em>rd</em>, with zero in all other bits. FSRM swaps the value in
<code>frm</code> by copying the original value into integer register <em>rd</em>, and then
writing a new value obtained from the three least-significant bits of integer
register <em>rs1</em> into <code>frm</code>. FRFLAGS and FSFLAGS are defined analogously for the
Accrued Exception Flags field <code>fflags</code> (<code>fcsr</code> bits 4&#8212;&#8203;0).</p>
</div>
<div class="paragraph">
<p>Bits 31&#8212;&#8203;8 of the <code>fcsr</code> are reserved for other standard extensions. If
these extensions are not present, implementations shall ignore writes to
these bits and supply a zero value when read. Standard software should
preserve the contents of these bits.</p>
</div>
<div class="paragraph">
<p>Floating-point operations use either a static rounding mode encoded in
the instruction, or a dynamic rounding mode held in <code>frm</code>. Rounding
modes are encoded as shown in <a href="#rm">Rounding mode encoding.</a>. A value of 111 in the
instruction&#8217;s <em>rm</em> field selects the dynamic rounding mode held in
<code>frm</code>. The behavior of floating-point instructions that depend on
rounding mode when executed with a reserved rounding mode is <em>reserved</em>, including both static reserved rounding modes (101-110) and dynamic reserved rounding modes (101-111). Some instructions, including widening conversions, have the <em>rm</em> field but are nevertheless mathematically unaffected by the rounding mode; software should set their <em>rm</em> field to
RNE (000) but implementations must treat the <em>rm</em> field as usual (in
particular, with regard to decoding legal vs. reserved encodings).</p>
</div>
<table id="rm" class="tableblock frame-all grid-all fit-content center">
<caption class="title">Table 2. Rounding mode encoding.</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Rounding Mode</th>
<th class="tableblock halign-center valign-top">Mnemonic</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">RNE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round to Nearest, ties to Even</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">001</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">RTZ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round towards Zero</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">010</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">RDN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round Down (towards \(-\infty\))</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">011</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">RUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round Up (towards \(+\infty\))</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">RMM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round to Nearest, ties to Max Magnitude</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">101</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Reserved for future use.</em></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">110</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Reserved for future use.</em></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">111</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">DYN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In instruction&#8217;s <em>rm</em> field, selects dynamic rounding mode; In Rounding Mode register, <em>reserved</em>.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The C99 language standard effectively mandates the provision of a
dynamic rounding mode register. In typical implementations, writes to
the dynamic rounding mode CSR state will serialize the pipeline. Static
rounding modes are used to implement specialized arithmetic operations
that often have to switch frequently between different rounding modes.</p>
</div>
<div class="paragraph">
<p>The ratified version of the F spec mandated that an illegal-instruction
exception was raised when an instruction was executed with a reserved
dynamic rounding mode. This has been weakened to reserved, which matches
the behavior of static rounding-mode instructions. Raising an
illegal-instruction exception is still valid behavior when encountering a
reserved encoding, so implementations compatible with the ratified spec
are compatible with the weakened spec.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The accrued exception flags indicate the exception conditions that have
arisen on any floating-point arithmetic instruction since the field was
last reset by software, as shown in <a href="#bitdef">Accrued exception flag encoding.</a>. The base
RISC-V ISA does not support generating a trap on the setting of a
floating-point exception flag.
</p>
</div>
<table id="bitdef" class="tableblock frame-all grid-all fit-content center">
<caption class="title">Table 3. Accrued exception flag encoding.</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Flag Mnemonic</th>
<th class="tableblock halign-left valign-top">Flag Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">NV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Invalid Operation</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">DZ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Divide by Zero</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">OF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Overflow</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">UF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Underflow</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">NX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inexact</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As allowed by the standard, we do not support traps on floating-point
exceptions in the F extension, but instead require explicit checks of
the flags in software. We considered adding branches controlled directly
by the contents of the floating-point accrued exception flags, but
ultimately chose to omit these instructions to keep the ISA simple.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="nan-generation-and-propagation"><a class="anchor" href="#nan-generation-and-propagation"></a>NaN Generation and Propagation</h3>
<div class="paragraph">
<p>Except when otherwise stated, if the result of a floating-point
operation is NaN, it is the canonical NaN. The canonical NaN has a
positive sign and all significand bits clear except the MSB, a.k.a. the
quiet bit. For single-precision floating-point, this corresponds to the pattern <code>0x7fc00000</code>.

</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We considered propagating NaN payloads, as is recommended by the
standard, but this decision would have increased hardware cost.
Moreover, since this feature is optional in the standard, it cannot be
used in portable code.</p>
</div>
<div class="paragraph">
<p>Implementors are free to provide a NaN payload propagation scheme as a
nonstandard extension enabled by a nonstandard operating mode. However, the canonical NaN scheme described above must always be supported and should be the default mode.</p>
</div>
</td>
</tr>
</table>
</div>
<hr>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We require implementations to return the standard-mandated default
values in the case of exceptional conditions, without any further
intervention on the part of user-level software (unlike the Alpha ISA
floating-point trap barriers). We believe full hardware handling of
exceptional cases will become more common, and so wish to avoid
complicating the user-level ISA to optimize other approaches.
Implementations can always trap to machine-mode software handlers to
provide exceptional default values.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="subnormal-arithmetic"><a class="anchor" href="#subnormal-arithmetic"></a>Subnormal Arithmetic</h3>
<div class="paragraph">
<p>Operations on subnormal numbers are handled in accordance with the IEEE 754-2008 standard.
</p>
</div>
<div class="paragraph">
<p>In the parlance of the IEEE standard, tininess is detected after
rounding.
</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Detecting tininess after rounding results in fewer spurious underflow
signals.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="single-precision-load-and-store-instructions"><a class="anchor" href="#single-precision-load-and-store-instructions"></a>Single-Precision Load and Store Instructions</h3>
<div class="paragraph">
<p>Floating-point loads and stores use the same base+offset addressing mode as the integer base ISAs, with a base address in register <em>rs1</em> and a 12-bit signed byte offset. The FLW instruction loads a single-precision floating-point value from memory into floating-point register <em>rd</em>. FSW stores a single-precision value from floating-point register <em>rs2</em> to memory.</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/unpriv/pages/f-st-ext.adoc - include::images/wavedrom/sp-load-store-2.edn[]</p>
</div>
<div id="sp-ldst" class="paragraph">
<p>FLW and FSW are only guaranteed to execute atomically if the effective
address is naturally aligned.</p>
</div>
<div class="paragraph">
<p>FLW and FSW do not modify the bits being transferred; in particular, the payloads of non-canonical NaNs are preserved.</p>
</div>
<div class="paragraph">
<p>As described in <a href="#ldst">[ldst]</a>, the execution environment defines whether misaligned floating-point loads and stores are handled invisibly or raise a contained or fatal trap.</p>
</div>
</div>
<div class="sect2">
<h3 id="single-float-compute"><a class="anchor" href="#single-float-compute"></a>Single-Precision Floating-Point Computational Instructions</h3>
<div class="paragraph">
<p>Floating-point arithmetic instructions with one or two source operands
use the R-type format with the OP-FP major opcode. FADD.S and FMUL.S
perform single-precision floating-point addition and multiplication
respectively, between <em>rs1</em> and <em>rs2</em>. FSUB.S performs the
single-precision floating-point subtraction of <em>rs2</em> from <em>rs1</em>. FDIV.S performs the single-precision floating-point division of <em>rs1</em> by <em>rs2</em>. FSQRT.S computes the square root of <em>rs1</em>. In each case, the result is written to <em>rd</em>.</p>
</div>
<div class="paragraph">
<p>The 2-bit floating-point format field <em>fmt</em> is encoded as shown in
<a href="#fmt">Format field encoding</a>. It is set to <em>S</em> (00) for all instructions in the F extension.</p>
</div>
<table id="fmt" class="tableblock frame-all grid-all fit-content center">
<caption class="title">Table 4. Format field encoding</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top"><em>fmt</em> field</th>
<th class="tableblock halign-center valign-top">Mnemonic</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">00</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">S</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32-bit single-precision</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">01</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64-bit double-precision</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">H</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16-bit half-precision</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">Q</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128-bit quad-precision</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>All floating-point operations that perform rounding can select the
rounding mode using the <em>rm</em> field with the encoding shown in
<a href="#rm">Rounding mode encoding.</a>.</p>
</div>
<div class="paragraph">
<p>Floating-point minimum-number and maximum-number instructions FMIN.S and FMAX.S write, respectively, the smaller or larger of <em>rs1</em> and <em>rs2</em> to <em>rd</em>. For the purposes of these instructions only, the value
\(-0.0\) is considered to be less than the value
\(+0.0\). If both inputs are NaNs, the result is the canonical NaN. If only one operand is a NaN, the result is the non-NaN operand.
Signaling NaN inputs set the invalid operation exception flag, even when the result is not NaN.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that in version 2.2 of the F extension, the FMIN.S and FMAX.S
instructions were amended to implement the proposed IEEE 754-201x
minimumNumber and maximumNumber operations, rather than the IEEE
754-2008 minNum and maxNum operations. These operations differ in their
handling of signaling NaNs.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/unpriv/pages/f-st-ext.adoc - include::images/wavedrom/spfloat.edn[]</p>
</div>
<div id="spfloat" class="paragraph">
<p></p>
</div>
<div class="paragraph">
<p>Floating-point fused multiply-add instructions require a new standard
instruction format. R4-type instructions specify three source registers (<em>rs1</em>, <em>rs2</em>, and <em>rs3</em>) and a destination register (<em>rd</em>). This format is only used by the floating-point fused multiply-add instructions.</p>
</div>
<div class="paragraph">
<p>FMADD.S multiplies the values in <em>rs1</em> and <em>rs2</em>, adds the value in
<em>rs3</em>, and writes the final result to <em>rd</em>. FMADD.S computes
<em>(rs1\(\times\)rs2)\(\+\)rs3</em>.</p>
</div>
<div class="paragraph">
<p>FMSUB.S multiplies the values in <em>rs1</em> and <em>rs2</em>, subtracts the value in <em>rs3</em>, and writes the final result to <em>rd</em>. FMSUB.S computes
<em>(rs1\(\times\)rs2)\(\-\)rs3</em>.</p>
</div>
<div class="paragraph">
<p>FNMSUB.S multiplies the values in <em>rs1</em> and <em>rs2</em>, negates the product, adds the value in <em>rs3</em>, and writes the final result to <em>rd</em>. FNMSUB.S computes <em>-(rs1\(\times\)rs2)\(\+\)rs3</em>.</p>
</div>
<div class="paragraph">
<p>FNMADD.S multiplies the values in <em>rs1</em> and <em>rs2</em>, negates the product, subtracts the value in <em>rs3</em>, and writes the final result to <em>rd</em>. FNMADD.S computes <em>-(rs1\(\times\)rs2)\(\-\)rs3</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The FNMSUB and FNMADD instructions are counterintuitively named, owing
to the naming of the corresponding instructions in MIPS-IV. The MIPS
instructions were defined to negate the sum, rather than negating the
product as the RISC-V instructions do, so the naming scheme was more
rational at the time. The two definitions differ with respect to
signed-zero results. The RISC-V definition matches the behavior of the
x86 and ARM fused multiply-add instructions, but unfortunately the
RISC-V FNMSUB and FNMADD instruction names are swapped as compared to x86,
whereas the RISC-V FMSUB and FNMSUB instruction names are swapped as
compared to ARM.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/unpriv/pages/f-st-ext.adoc - include::images/wavedrom/spfloat2.edn[]</p>
</div>
<div id="fnmaddsub" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The fused multiply-add (FMA) instructions consume a large part of the
32-bit instruction encoding space. Some alternatives considered were to
restrict FMA to only use dynamic rounding modes, but static rounding
modes are useful in code that exploits the lack of product rounding.
Another alternative would have been to use rd to provide rs3, but this
would require additional move instructions in some common sequences. The current design still leaves a large portion of the 32-bit encoding space open while avoiding having FMA be non-orthogonal.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The fused multiply-add instructions must set the invalid operation
exception flag when the multiplicands are \(\infty\) and zero, even when the addend is a quiet NaN.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The IEEE 754-2008 standard permits, but does not require, raising the
invalid exception for the operation \(\infty\times 0\ +\)qNaN.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="single-precision-floating-point-conversion-and-move-instructions"><a class="anchor" href="#single-precision-floating-point-conversion-and-move-instructions"></a>Single-Precision Floating-Point Conversion and Move Instructions</h3>
<div class="paragraph">
<p>Floating-point-to-integer and integer-to-floating-point conversion
instructions are encoded in the OP-FP major opcode space. FCVT.W.S or
FCVT.L.S converts a floating-point number in floating-point register
<em>rs1</em> to a signed 32-bit or 64-bit integer, respectively, in integer
register <em>rd</em>. FCVT.S.W or FCVT.S.L converts a 32-bit or 64-bit signed
integer, respectively, in integer register <em>rs1</em> into a floating-point
number in floating-point register <em>rd</em>. FCVT.WU.S, FCVT.LU.S, FCVT.S.WU,
and FCVT.S.LU variants convert to or from unsigned integer values. For
XLEN\(&gt;32\), FCVT.W[U].S sign-extends the 32-bit result to the
destination register width. FCVT.L[U].S and FCVT.S.L[U] are RV64-only
instructions. If the rounded result is not representable in the
destination format, it is clipped to the nearest value and the invalid
flag is set. <a href="#int_conv">Domains of float-to-integer conversions and behavior for invalid inputs</a> gives the range of valid inputs
for FCVT.<em>int</em>.S and the behavior for invalid inputs.
</p>
</div>
<div class="paragraph">
<p>All floating-point to integer and integer to floating-point conversion
instructions round according to the <em>rm</em> field. A floating-point
register can be initialized to floating-point positive zero using
FCVT.S.W <em>rd</em>, <code>x0</code>, which will never set any exception flags.</p>
</div>
<table id="int_conv" class="tableblock frame-all grid-all fit-content center">
<caption class="title">Table 5. Domains of float-to-integer conversions and behavior for invalid inputs</caption>
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-right valign-top">FCVT.W.S</th>
<th class="tableblock halign-right valign-top">FCVT.WU.S</th>
<th class="tableblock halign-right valign-top">FCVT.L.S</th>
<th class="tableblock halign-right valign-top">FCVT.LU.S</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minimum valid input (after rounding)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(-2^{31}\)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(-2^{63}\)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum valid input (after rounding)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(2^{31}-1\)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(2^{32}-1\)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(2^{63}-1\)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(2^{64}-1\)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Output for out-of-range negative input</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(-2^{31}\)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(-2^{63}\)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Output for \(-\infty\)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(-2^{31}\)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(-2^{63}\)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Output for out-of-range positive input</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(2^{31}-1\)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(2^{32}-1\)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(2^{63}-1\)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(2^{64}-1\)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Output for \(+\infty\) or NaN</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(2^{31}-1\)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(2^{32}-1\)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(2^{63}-1\)</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">\(2^{64}-1\)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>All floating-point conversion instructions set the Inexact exception
flag if the rounded result differs from the operand value and the
Invalid exception flag is not set.</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/unpriv/pages/f-st-ext.adoc - include::images/wavedrom/spfloat-cn-cmp.edn[]</p>
</div>
<div id="fcvt" class="paragraph">
<p>Floating-point to floating-point sign-injection instructions, FSGNJ.S,
FSGNJN.S, and FSGNJX.S, produce a result that takes all bits except the
sign bit from <em>rs1</em>. For FSGNJ, the result&#8217;s sign bit is <em>rs2</em>'s sign
bit; for FSGNJN, the result&#8217;s sign bit is the opposite of <em>rs2</em>'s sign
bit; and for FSGNJX, the sign bit is the XOR of the sign bits of <em>rs1</em>
and <em>rs2</em>. Sign-injection instructions do not set floating-point
exception flags, nor do they canonicalize NaNs. Note, FSGNJ.S <em>rx, ry,
ry</em> moves <em>ry</em> to <em>rx</em> (assembler pseudoinstruction FMV.S <em>rx, ry</em>);
FSGNJN.S <em>rx, ry, ry</em> moves the negation of <em>ry</em> to <em>rx</em> (assembler
pseudoinstruction FNEG.S <em>rx, ry</em>); and FSGNJX.S <em>rx, ry, ry</em> moves the absolute value of <em>ry</em> to <em>rx</em> (assembler pseudoinstruction FABS.S <em>rx,
ry</em>).</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/unpriv/pages/f-st-ext.adoc - include::images/wavedrom/spfloat-sign-inj.edn[]</p>
</div>
<div id="inj" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The sign-injection instructions provide floating-point MV, ABS, and NEG, as well as supporting a few other operations, including the IEEE
copySign operation and sign manipulation in transcendental math function libraries. Although MV, ABS, and NEG only need a single register operand, whereas FSGNJ instructions need two, it is unlikely most microarchitectures would add optimizations to benefit from the reduced number of register reads for these relatively infrequent instructions. Even in this case, a microarchitecture can simply detect when both source registers are the same for FSGNJ instructions and only read a single copy.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Instructions are provided to move bit patterns between the
floating-point and integer registers. FMV.X.W moves the single-precision value in floating-point register <em>rs1</em> represented in IEEE 754-2008 encoding to the lower 32 bits of integer register <em>rd</em>. The bits are not modified in the transfer, and in particular, the payloads of non-canonical NaNs are preserved. For RV64, the higher 32 bits of the destination register are filled with copies of the floating-point number&#8217;s sign bit.</p>
</div>
<div class="paragraph">
<p>FMV.W.X moves the single-precision value encoded in IEEE 754-2008
standard encoding from the lower 32 bits of integer register <em>rs1</em> to
the floating-point register <em>rd</em>. The bits are not modified in the
transfer, and in particular, the payloads of non-canonical NaNs are
preserved.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The FMV.W.X and FMV.X.W instructions were previously called FMV.S.X and FMV.X.S. The use of W is more consistent with their semantics as an instruction that moves 32 bits without interpreting them. This became clearer after defining NaN-boxing. To avoid disturbing existing code, both the W and S versions will be supported by tools.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/unpriv/pages/f-st-ext.adoc - include::images/wavedrom/spfloat-mv.edn[]</p>
</div>
<div id="spfloat-mv" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The base floating-point ISA was defined so as to allow implementations
to employ an internal recoding of the floating-point format in registers to simplify handling of subnormal values and possibly to reduce functional unit latency. To this end, the F extension avoids
representing integer values in the floating-point registers by defining conversion and comparison operations that read and write the integer register file directly. This also removes many of the common cases where explicit moves between integer and floating-point registers are required, reducing instruction count and critical paths for common mixed-format code sequences.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="single-precision-floating-point-compare-instructions"><a class="anchor" href="#single-precision-floating-point-compare-instructions"></a>Single-Precision Floating-Point Compare Instructions</h3>
<div class="paragraph">
<p>Floating-point compare instructions (FEQ.S, FLT.S, FLE.S) perform the
specified comparison between floating-point registers
(\(\mbox{\em rs1}
= \mbox{\em rs2}\), \(\mbox{\em rs1} &lt; \mbox{\em rs2}\),
\(\mbox{\em rs1} \leq
\mbox{\em rs2}\)) writing 1 to the integer register <em>rd</em> if the
condition holds, and 0 otherwise.</p>
</div>
<div class="paragraph">
<p>FLT.S and FLE.S perform what the IEEE 754-2008 standard refers to as
<em>signaling</em> comparisons: that is, they set the invalid operation
exception flag if either input is NaN. FEQ.S performs a <em>quiet</em>
comparison: it only sets the invalid operation exception flag if either input is a signaling NaN. For all three instructions, the result is 0 if either operand is NaN.</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/unpriv/pages/f-st-ext.adoc - include::images/wavedrom/spfloat-comp.edn[]</p>
</div>
<div id="spfloat-comp" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The F extension provides a \(\leq\) comparison, whereas the
base ISAs provide a \(\geq\) branch comparison. Because
\(\leq\) can be synthesized from \(\geq\) and
vice-versa, there is no performance implication to this inconsistency,
but it is nevertheless an unfortunate incongruity in the ISA.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="single-precision-floating-point-classify-instruction"><a class="anchor" href="#single-precision-floating-point-classify-instruction"></a>Single-Precision Floating-Point Classify Instruction</h3>
<div class="paragraph">
<p>The FCLASS.S instruction examines the value in floating-point register
<em>rs1</em> and writes to integer register <em>rd</em> a 10-bit mask that indicates
the class of the floating-point number. The format of the mask is
described in <a href="#fclass">Format of result of FCLASS instruction.</a>. The corresponding bit in <em>rd</em> will
be set if the property is true and clear otherwise. All other bits in
<em>rd</em> are cleared. Note that exactly one bit in <em>rd</em> will be set.
FCLASS.S does not set the floating-point exception flags.
</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/unpriv/pages/f-st-ext.adoc - include::images/wavedrom/spfloat-classify.edn[]</p>
</div>
<table id="fclass" class="tableblock frame-all grid-all fit-content center">
<caption class="title">Table 6. Format of result of FCLASS instruction.</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top"><em>rd</em> bit</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs1</em> is \(-\infty\).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs1</em> is a negative normal number.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs1</em> is a negative subnormal number.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs1</em> is \(-0\).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs1</em> is \(+0\).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs1</em> is a positive subnormal number.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs1</em> is a positive normal number.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs1</em> is \(+\infty\).</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs1</em> is a signaling NaN.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>rs1</em> is a quiet NaN.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="cmo.html">"CMO" Extensions for Base Cache Management Operation ISA, Version 1.0.0</a></span>
  <span class="next"><a href="d-st-ext.html">"D" Extension for Double-Precision Floating-Point, Version 2.2</a></span>
</nav>
</article>  </div>
</main>
<div class="modal micromodal-slide" id="modal-versions" aria-hidden="true">
    <div class="modal__overlay" tabindex="-1" data-micromodal-close>
        <div class="modal__container" role="dialog" aria-modal="true">
            <main class="modal__content" id="modal-versions-content">
              <button data-micromodal-close class="modal-versions-close">
                <svg width="28px" height="28px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><defs><style>.cls-1h{fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px;}</style></defs><title/><g id="cross"><line class="cls-1h" x1="7" x2="25" y1="7" y2="25"/><line class="cls-1h" x1="7" x2="25" y1="25" y2="7"/></g></svg>
              </button>
              <div class="colset">
                <div class="col-left">
                  <ul class="nav-versions">
                    <li class="component">
                      <a class="title" href="../../etrace/index.html">E-Trace Encapsulation Specification</a>
                      <ul class="versions">
                        <li class="version is-latest">
                          <a href="../../etrace/index.html">
                            default<span class="current">current</span>
                          </a>
                        </li>
                      </ul>
                    </li>
                    <li class="component is-current">
                      <a class="title" href="../index.html">ISA Specifications</a>
                      <ul class="versions">
                        <li class="version is-current is-latest">
                          <a href="../index.html">
                            default<span class="current">current</span>
                          </a>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </div>
                <div class="col-right">
                                  </div>
              </div>
            </main>
        </div>
    </div>
</div>

</div>
<footer class="footer">
<p>
  This page was built using a customized version of the
  <a href="https://github.com/spring-io/antora-ui-spring" target="_blank">Antora Spring UI</a>.
</p>
<p>
  The source code for this UI is licensed under the terms of the Mozilla Public License Version 2.0.
</p>
</footer>
<script src="../../_/js/vendor/import.js"></script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script async src="../../_/js/vendor/spring-tabs.js" data-sync-storage-key="docs:preferred-tab"></script>
  </body>
</html>
